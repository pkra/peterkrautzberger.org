<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>How to include MathJax in an epub3 file to work with iBooks (and possibly others)</title>
		<link rel="stylesheet" href="/css/index.css">
		<link rel="alternate" href="/atom.xml" type="application/atom+xml" title="Peter Krautzberger">
    <meta name="Description" content="How to include MathJax in an epub3 file to work with iBooks (and possibly others)">
    <meta name="theme-color" content="#fff">
		<link rel="apple-touch-icon" sizes="180x180" href="/public/apple-touch-icon-180x180.png ">
    <link rel="shortcut icon" href="/public/favicon.ico">
    <link rel="manifest" href="/public/manifest.json">
    <script>if ('serviceWorker' in navigator) {  navigator.serviceWorker.register('/serviceworker.js');}</script>
	</head>
	<body>
  <header>
    <div class="masthead">
      <div class="container">
        <div class="masthead-title">
          <a href="/">Peter Krautzberger</a>
          <small> Â· on the web</small>
        </div>
      </div>
    </div>
  </header>

		<main class="container content">
			


<article class="post">
  <h1 class="post-title">How to include MathJax in an epub3 file to work with iBooks (and possibly others)</h1>
  <span class="post-date"><time datetime="2013-01-13">13 Jan 2013</time></span>
  <p>At the Joint Mathematics Meetings <a href="http://jointmathematicsmeetings.org/meetings/national/jmm2013/2141_program_ss62.html">Present and Future of Mathematics on the Web</a> session, Lila Roberts presented an excellent demo of the good stuff you can do with iBooks author. The demo included MathJax and jsxgraph, and combined both with iBooks Author's easy, pretty layout tools. Of course, the drawback is that iBooks Author is</p>
<ul>
<li>a proprietary format</li>
<li>restricted to iPads (not just iOS)</li>
<li>you're not allowed to sell an iBooks Author file except through iTunes.</li>
<li>iBooks Author is not transparent about how its formula editor produces SVGs out of TeX but pastes MathML directly into a page, leading to inconsistent renderings of equivalent mathematics</li>
<li>MathML support of iBooks on iOS5 devices is severly broken (and will likely never be fixed) thanks to a mobile Safari bug that screws up the use of STIX fonts.</li>
</ul>
<p>Anyway, I mentioned in the session that you can actually include MathJax in epub3 files directly to get much of the same. Well, you have to do the pretty layouts yourself and you'll depend on a javascript-enabled epub3 reading software (like iBooks) but at least you're using an open standard and retain your rights.</p>
<h2>Let's get started!</h2>
<p>If you're lazy, grab the file at the end of the post and hack from there. But I'll walk you through it.</p>
<ul>
<li>If you want to learn something, grab a copy of <a href="http://github.com/mathjax/mathjax">MathJax</a></li>
<li>slim it down as described <a href="https://github.com/mathjax/MathJax/wiki/Shrinking-MathJax-for-%22local%22-installation">here</a></li>
<li>I went all the way and restricted output to SVG -- to minimize things and to make it work. HTML output should work on iOS5, but last I checked Apple changed something on iOS6 that I couldn't track down for lack of devices.</li>
</ul>
<p>Alright, that's the basics. You now have a copy of MathJax that works on any reasonably recent webkit browser, including most Android and iOS versions.</p>
<p>You have all inputs (LaTeX, asciimath, MathML) available but only SVG output (well, and native MathML but if that worked we wouldn't be here...).</p>
<h2>What's next?</h2>
<p>Create your document. That's actually hard if you don't have a workflow already and don't want to afford InDesign, Blue Griffon etc.</p>
<p>Personally, I will always try pandoc first. It's the most versatile tool there is and John McFarlane is just fantastic. Its TeX implementation is enough if you are writing TeX with HTML/epub output in mind, I'm sure you won't run into trouble.</p>
<p>If you can, consider to go through the Haskell-cabal-pain of installing the current development version -- see the instructions <a href="https://github.com/jgm/pandoc/wiki/Installing-the-development-version-of-pandoc-1.10">at the pandoc github wiki</a>. That will get you the new epub3 writer and things should be easy.</p>
<p>Of course, you can hack the example file below and just use a current version of pandoc or whatever you like to generate some xHTML5 (yes, xhtml, not html if you want your file to validate). You'll have to modify the manifest etc by hand.</p>
<p>Anyway, let's daringly assume you have an epub3 with your xhtml+mathml content.</p>
<h2>Adding MathJax.</h2>
<ul>
<li>add the slim down version of MathJax to your epub file using your favoriate tool for adding content to a zip file. (Don't unzip/rezip unless you know what epub needs when zipping...)</li>
<li>Assuming you're using the copy as in the attachement, add the following to your manifest (modify paths and id's if needed)<pre><code>&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Regular/BasicLatin.js" id="id0" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/MiscMathSymbolsB.js" id="id1" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/d.js" id="id2" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/jax.js" id="id3" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/cancel.js" id="id4" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/a.js" id="id5" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/AsciiMath/jax.js" id="id6" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/autoload/ms.js" id="id7" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/mathchoice.js" id="id8" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Script/Regular/Main.js" id="id9" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/extpfeil.js" id="id10" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/AsciiMath/config.js" id="id11" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/Arrows.js" id="id12" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/images/CloseX-31.png" id="id13" media-type="image/png"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Italic/LatinExtendedA.js" id="id14" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/SansSerif/Italic/Other.js" id="id15" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Size3/Regular/Main.js" id="id16" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Size2/Regular/Main.js" id="id17" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/images/MenuArrow-15.png" id="id18" media-type="image/png"/&gt;
&lt;item href="mathjax/jax/input/TeX/jax.js" id="id19" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Size1/Regular/Main.js" id="id20" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/h.js" id="id21" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/l.js" id="id22" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Fraktur/Bold/PUA.js" id="id23" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/AMSsymbols.js" id="id24" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Regular/CombDiacritMarks.js" id="id25" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Fraktur/Regular/PUA.js" id="id26" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/GreekAndCoptic.js" id="id27" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Italic/LatinExtendedB.js" id="id28" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/LatinExtendedA.js" id="id29" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/MiscSymbols.js" id="id30" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/scr.js" id="id31" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Regular/MiscSymbols.js" id="id32" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/MiscTechnical.js" id="id33" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/newcommand.js" id="id34" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/autoload/mmultiscripts.js" id="id35" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/p.js" id="id36" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Typewriter/Regular/Main.js" id="id37" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/o.js" id="id38" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/autoload/annotation-xml.js" id="id39" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/u.js" id="id40" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Fraktur/Bold/BasicLatin.js" id="id41" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Fraktur/Regular/BasicLatin.js" id="id42" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Size4/Regular/Main.js" id="id43" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/noUndefined.js" id="id44" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/k.js" id="id45" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/LetterlikeSymbols.js" id="id46" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/HTML.js" id="id47" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Fraktur/Regular/Main.js" id="id49" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/MiscSymbolsAndArrows.js" id="id50" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/SansSerif/Bold/BasicLatin.js" id="id51" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/GeometricShapes.js" id="id52" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/GeometricShapes.js" id="id53" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/config.js" id="id54" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/enclose.js" id="id55" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/EnclosedAlphanum.js" id="id56" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/mhchem.js" id="id57" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/verb.js" id="id58" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/GeneralPunctuation.js" id="id59" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/MathMenu.js" id="id60" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/GeometricShapes.js" id="id61" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/PUA.js" id="id62" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Italic/LetterlikeSymbols.js" id="id63" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/z.js" id="id64" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Fraktur/Bold/Main.js" id="id65" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/SpacingModLetters.js" id="id66" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Fraktur/Bold/Other.js" id="id67" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/autoload-all.js" id="id68" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/SansSerif/Bold/CombDiacritMarks.js" id="id69" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/noErrors.js" id="id70" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/g.js" id="id71" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/SansSerif/Regular/BasicLatin.js" id="id72" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Regular/SpacingModLetters.js" id="id73" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/MiscSymbols.js" id="id74" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Regular/GreekAndCoptic.js" id="id75" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Italic/Main.js" id="id76" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/mml2jax.js" id="id77" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Regular/GeometricShapes.js" id="id78" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/i.js" id="id79" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/q.js" id="id80" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/toMathML.js" id="id81" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/NativeMML/config.js" id="id82" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/BasicLatin.js" id="id83" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/boldsymbol.js" id="id84" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Typewriter/Regular/Other.js" id="id85" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/BoxDrawing.js" id="id86" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/begingroup.js" id="id87" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/v.js" id="id88" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/MiscMathSymbolsA.js" id="id89" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Math/BoldItalic/Main.js" id="id90" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/SansSerif/Bold/Other.js" id="id91" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/autoload/menclose.js" id="id92" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/LetterlikeSymbols.js" id="id93" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Typewriter/Regular/CombDiacritMarks.js" id="id94" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Italic/GeneralPunctuation.js" id="id95" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/MiscMathSymbolsB.js" id="id96" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/x.js" id="id97" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/SansSerif/Regular/Other.js" id="id98" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/j.js" id="id99" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/MathZoom.js" id="id100" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/MiscMathSymbolsA.js" id="id101" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/unicode.js" id="id102" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/c.js" id="id103" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/NativeMML/jax.js" id="id104" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/SupplementalArrowsB.js" id="id105" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/autobold.js" id="id106" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/SuppMathOperators.js" id="id107" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/SansSerif/Regular/Main.js" id="id108" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/action.js" id="id109" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/fr.js" id="id110" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/Dingbats.js" id="id111" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/Dingbats.js" id="id112" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/SansSerif/Italic/CombDiacritMarks.js" id="id113" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/Arrows.js" id="id114" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/MathEvents.js" id="id115" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Italic/MathOperators.js" id="id116" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Caligraphic/Bold/Main.js" id="id117" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Regular/MathOperators.js" id="id118" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/Latin1Supplement.js" id="id119" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/CombDiacritMarks.js" id="id120" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/f.js" id="id121" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/Main.js" id="id122" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/bbox.js" id="id123" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/config.js" id="id124" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/CombDiactForSymbols.js" id="id125" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/SansSerif/Regular/CombDiacritMarks.js" id="id126" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/Arrows.js" id="id127" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/SupplementalArrowsA.js" id="id128" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/r.js" id="id129" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/GeneralPunctuation.js" id="id130" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/SansSerif/Italic/BasicLatin.js" id="id131" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/SuppMathOperators.js" id="id132" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/opf.js" id="id133" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/fontdata.js" id="id134" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/SpacingModLetters.js" id="id135" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/autoload/mglyph.js" id="id136" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/MathOperators.js" id="id137" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Italic/GreekAndCoptic.js" id="id138" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/CombDiactForSymbols.js" id="id139" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/SansSerif/Bold/Main.js" id="id140" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/w.js" id="id141" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/MiscTechnical.js" id="id142" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/Latin1Supplement.js" id="id143" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/MathOperators.js" id="id144" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Regular/LetterlikeSymbols.js" id="id146" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/m.js" id="id147" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/GeneralPunctuation.js" id="id148" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/autoload/multiline.js" id="id149" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/LatinExtendedA.js" id="id150" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/autoload/mtable.js" id="id151" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Regular/LatinExtendedA.js" id="id152" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/SansSerif/Italic/Main.js" id="id153" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/asciimath2jax.js" id="id154" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/jax.js" id="id155" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/AMSmath.js" id="id156" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/b.js" id="id157" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/fontdata-extra.js" id="id158" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/SuppMathOperators.js" id="id159" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/MathOperators.js" id="id160" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/s.js" id="id161" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Script/Regular/BasicLatin.js" id="id162" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Caligraphic/Regular/Main.js" id="id163" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/SpacingModLetters.js" id="id164" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/GreekAndCoptic.js" id="id165" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Italic/BasicLatin.js" id="id166" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/SupplementalArrowsA.js" id="id167" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/MathJax.js" id="id168" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/TeX/config.js" id="id169" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/BasicLatin.js" id="id170" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/CombDiacritMarks.js" id="id171" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/TeX/color.js" id="id172" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/Main.js" id="id173" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Regular/LatinExtendedB.js" id="id174" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Italic/CombDiacritMarks.js" id="id175" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Fraktur/Regular/Other.js" id="id176" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/extensions/tex2jax.js" id="id177" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/MiscTechnical.js" id="id178" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/autoload/maction.js" id="id179" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/GreekAndCoptic.js" id="id180" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Bold/LatinExtendedB.js" id="id181" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/n.js" id="id182" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/t.js" id="id183" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Typewriter/Regular/BasicLatin.js" id="id184" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Regular/SuppMathOperators.js" id="id185" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/y.js" id="id186" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/jax.js" id="id187" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/input/MathML/entities/e.js" id="id188" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/LetterlikeSymbols.js" id="id189" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/AMS/Regular/Latin1Supplement.js" id="id190" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/element/mml/optable/CombDiacritMarks.js" id="id191" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Math/Italic/Main.js" id="id192" media-type="application/x-javascript"/&gt;
&lt;item href="mathjax/jax/output/SVG/fonts/TeX/Main/Regular/Main.js" id="id193" media-type="application/x-javascript"/&gt;
</code></pre>
</li>
<li>To each xhtml file that contains MathML, add<pre><code>&lt;script type="text/x-mathjax-config"&gt;
MathJax.Hub.Config({
jax: ["input/TeX","input/MathML","output/SVG"],
extensions: ["tex2jax.js","mml2jax.js","MathEvents.js"],
TeX: {
extensions: ["noErrors.js","noUndefined.js","autoload-all.js"]
},
MathMenu: {
showRenderer: false
},
menuSettings: {
zoom: "Click"
},
messageStyle: "none"
});
&lt;/script&gt;
&lt;script type="text/javascript" src="../mathjax/MathJax.js"&gt; &lt;/script&gt;
</code></pre>
</li>
<li>I have not activated automatic linebreaking because there's currently <a href="http://github.com/mathjax/mathjax/issues/368">a bug</a> in MathJax on iOS6. If MathJax detects the need to break the line, you'll get Math Processing errors instead.</li>
<li>For each xhtml file with the above we'll have to modify the <code>properties</code>-part in the manifest to have both <code>mathml scripted</code>, e.g., in the sample file you'll see
<ul>
<li><code>&lt;item id="c3" media-type="application/xhtml+xml" href="xhtml/ch1.html" properties="mathml scripted"/&gt;</code></li>
</ul>
</li>
<li>And then you can include wonderful MathML and even webkit deficiencies or the horrible iOS5 Safari+STIX bug will be meaningless to your epub file and you can actually publish a mathematical epub file to be read on iBooks.<br>
<mjx-container class="MathJax" jax="SVG" overflow="overflow" role="tree" data-owns="2 3 9 10 18" aria-label="ModifyingAbove x With caret plus ModifyingAbove x y With caret plus ModifyingAbove x y z With caret" aria-braillelabel="â â ­â £â ¸â £â »â ¬â â ­â ½â £â ¸â £â »â ¬â â ­â ½â µâ £â ¸â £â »" aria-level="1"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="12.735ex" height="2.33ex" role="img" focusable="false" viewBox="0 -825 5628.9 1030" xmlns:xlink="http://www.w3.org/1999/xlink"><defs role="presentation"><path id="MJX-1185-MM-I-1D465" d="M527 376C527 428 468 442 434 442C376 442 341 389 329 366C304 432 250 442 221 442C117 442 60 313 60 288C60 278 72 278 72 278C80 278 83 280 85 289C119 395 185 420 219 420C238 420 273 411 273 353C273 322 256 255 219 115C203 53 168 11 124 11C118 11 95 11 74 24C99 29 121 50 121 78C121 105 99 113 84 113C54 113 29 87 29 55C29 9 79-11 123-11C189-11 225 59 228 65C240 28 276-11 336-11C439-11 496 118 496 143C496 153 487 153 484 153C475 153 473 149 471 142C438 35 370 11 338 11C299 11 283 43 283 77C283 99 289 121 300 165L334 302C340 328 363 420 433 420C438 420 462 420 483 407C455 402 435 377 435 353C435 337 446 318 473 318C495 318 527 336 527 376Z" role="presentation" /><path id="MJX-1185-MM-N-302" d="M-82 607C-138 656-199 698-264 734C-329 698-390 656-446 607L-434 587C-376 612-319 641-264 672C-209 641-152 612-94 587Z" role="presentation" /><path id="MJX-1185-MM-N-2B" d="M722 250C722 261 713 270 702 270L409 270L409 563C409 574 400 583 389 583C378 583 369 574 369 563L369 270L76 270C65 270 56 261 56 250C56 239 65 230 76 230L369 230L369-63C369-74 378-83 389-83C400-83 409-74 409-63L409 230L702 230C713 230 722 239 722 250Z" role="presentation" /><path id="MJX-1185-MM-N-2062" d="" role="presentation" /><path id="MJX-1185-MM-I-1D466" d="M490 404C490 422 476 431 461 431C451 431 435 425 426 410C424 405 416 374 412 356L392 276L347 96C343 81 300 11 234 11C183 11 172 55 172 92C172 138 189 200 223 288C239 329 243 340 243 360C243 405 211 442 161 442C66 442 29 297 29 288C29 278 41 278 41 278C51 278 52 280 57 296C84 390 124 420 158 420C166 420 183 420 183 388C183 363 173 337 166 318C126 212 108 155 108 108C108 19 171-11 230-11C269-11 303 6 331 34C318-18 306-67 266-120C240-154 202-183 156-183C142-183 97-180 80-141C96-141 109-141 123-129C133-120 143-107 143-88C143-57 116-53 106-53C83-53 50-69 50-118C50-168 94-205 156-205C259-205 362-114 390-1L486 381C490 395 490 397 490 404Z" role="presentation" /><path id="MJX-1185-MM-S4-302" d="M1100 597C919 653 735 703 550 747C365 703 182 653 0 597L6 571C189 604 370 642 550 685C730 642 912 604 1094 571Z" role="presentation" /><path id="MJX-1185-MM-I-1D467" d="M467 432C467 442 456 442 456 442C449 442 446 440 441 431C411 383 390 367 366 367C342 367 330 382 315 399C296 422 279 442 246 442C171 442 125 349 125 328C125 323 128 317 137 317C146 317 148 322 150 328C169 374 227 375 235 375C256 375 275 368 298 360C338 345 349 345 375 345C339 302 255 230 236 214L146 130C78 63 43 6 43-1C43-11 55-11 55-11C63-11 65-9 71 2C94 37 124 64 156 64C179 64 189 55 214 26C231 5 249-11 278-11C377-11 435 116 435 143C435 148 431 153 423 153C414 153 412 147 409 140C386 75 322 56 289 56C269 56 251 62 230 69C196 82 181 86 160 86C160 86 142 86 133 83C187 141 216 166 252 197C252 197 314 251 350 287C445 380 467 428 467 432Z" role="presentation" /><path id="MJX-1185-MM-S6-302" d="M1581 598L790 748L0 598L5 570L790 684L1576 570Z" role="presentation" /></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)" role="presentation"><g data-mml-node="math" data-semantic-type="infixop" data-semantic-role="addition" data-semantic-id="19" data-semantic-children="2,9,18" data-semantic-content="3,10" role="presentation" data-semantic-owns="2 3 9 10 18" data-semantic-structure="(19 (2 0 1) 3 (9 (7 4 6 5) 8) 10 (18 (16 11 14 12 15 13) 17))" data-semantic-speech="ModifyingAbove x With caret plus ModifyingAbove x y With caret plus ModifyingAbove x y z With caret" data-semantic-braille="â â ­â £â ¸â £â »â ¬â â ­â ½â £â ¸â £â »â ¬â â ­â ½â µâ £â ¸â £â »" data-owns-id="19"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" role="presentation"><g data-mml-node="mover" data-semantic-type="overscore" data-semantic-role="latinletter" data-semantic-id="2" data-semantic-children="0,1" data-semantic-parent="19" data-semantic-attributes="texclass:ORD" aria-level="2" aria-posinset="1" aria-setsize="5" role="treeitem" data-semantic-owns="0 1" data-semantic-speech="ModifyingAbove x With caret" data-semantic-braille="â â ­â £â ¸â £â »" data-owns-id="2" aria-label="ModifyingAbove x With caret" aria-braillelabel="â â ­â £â ¸â £â »" aria-hidden="true" data-owns="0 1"><g data-mml-node="mi" data-semantic-type="identifier" data-semantic-role="latinletter" data-semantic-font="italic" data-semantic-annotation="clearspeak:simple;nemeth:number" data-semantic-id="0" data-semantic-parent="2" aria-level="3" aria-posinset="1" aria-setsize="2" role="treeitem" data-semantic-speech="x" data-semantic-prefix="Base" data-semantic-braille="â ­" data-owns-id="0" aria-label="Base x" aria-braillelabel="â ­" aria-hidden="true"><use data-c="1D465" xlink:href="#MJX-1185-MM-I-1D465" role="presentation" /></g><g data-mml-node="mo" data-semantic-type="operator" data-semantic-role="overaccent" data-semantic-annotation="accent:unknown" data-semantic-id="1" data-semantic-parent="2" aria-level="3" aria-posinset="2" aria-setsize="2" role="treeitem" data-semantic-speech="caret" data-semantic-prefix="Overscript" transform="translate(593,-40)" data-semantic-braille="â ¸â £" data-owns-id="1" aria-label="Overscript caret" aria-braillelabel="â ¸â £" aria-hidden="true"><use data-c="302" xlink:href="#MJX-1185-MM-N-302" role="presentation" /></g></g></g><g data-mml-node="mo" data-semantic-type="operator" data-semantic-role="addition" data-semantic-id="3" data-semantic-parent="19" data-semantic-operator="infixop,+" aria-level="2" aria-posinset="2" aria-setsize="5" role="treeitem" data-semantic-speech="plus" transform="translate(815.2,0)" data-semantic-braille="â ¬" data-owns-id="3" aria-label="plus" aria-braillelabel="â ¬" aria-hidden="true"><use data-c="2B" xlink:href="#MJX-1185-MM-N-2B" role="presentation" /></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1815.4,0)" role="presentation"><g data-mml-node="mover" data-semantic-type="overscore" data-semantic-role="implicit" data-semantic-id="9" data-semantic-children="7,8" data-semantic-parent="19" data-semantic-attributes="texclass:ORD" aria-level="2" aria-posinset="3" aria-setsize="5" role="treeitem" data-semantic-owns="7 8" data-semantic-speech="ModifyingAbove x y With caret" data-semantic-braille="â â ­â ½â £â ¸â £â »" data-owns-id="9" aria-label="ModifyingAbove x y With caret" aria-braillelabel="â â ­â ½â £â ¸â £â »" aria-hidden="true" data-owns="7 8"><g data-mml-node="mrow" data-semantic-type="infixop" data-semantic-role="implicit" data-semantic-annotation="clearspeak:simple;clearspeak:unit" data-semantic-id="7" data-semantic-children="4,5" data-semantic-content="6" data-semantic-parent="9" aria-level="3" aria-posinset="1" aria-setsize="2" role="treeitem" data-semantic-owns="4 6 5" data-semantic-speech="x y" data-semantic-prefix="Base" data-semantic-braille="â ­â ½" data-owns-id="7" aria-label="Base x y" aria-braillelabel="â ­â ½" aria-hidden="true" data-owns="4 6 5"><g data-mml-node="mi" data-semantic-type="identifier" data-semantic-role="latinletter" data-semantic-font="italic" data-semantic-annotation="clearspeak:simple" data-semantic-id="4" data-semantic-parent="7" aria-level="4" aria-posinset="1" aria-setsize="3" role="treeitem" data-semantic-speech="x" data-semantic-braille="â ­" data-owns-id="4" aria-label="x" aria-braillelabel="â ­" aria-hidden="true"><use data-c="1D465" xlink:href="#MJX-1185-MM-I-1D465" role="presentation" /></g><g data-mml-node="mo" data-semantic-type="operator" data-semantic-role="multiplication" data-semantic-id="6" data-semantic-parent="7" data-semantic-added="true" data-semantic-operator="infixop,â¢" aria-level="4" aria-posinset="2" aria-setsize="3" role="treeitem" data-semantic-speech="times" transform="translate(572,0)" data-semantic-braille="â â ¡" data-owns-id="6" aria-label="times" aria-braillelabel="â â ¡" aria-hidden="true"><use data-c="2062" xlink:href="#MJX-1185-MM-N-2062" role="presentation" /></g><g data-mml-node="mi" data-semantic-type="identifier" data-semantic-role="latinletter" data-semantic-font="italic" data-semantic-annotation="clearspeak:simple" data-semantic-id="5" data-semantic-parent="7" aria-level="4" aria-posinset="3" aria-setsize="3" role="treeitem" data-semantic-speech="y" transform="translate(572,0)" data-semantic-braille="â ½" data-owns-id="5" aria-label="y" aria-braillelabel="â ½" aria-hidden="true"><use data-c="1D466" xlink:href="#MJX-1185-MM-I-1D466" role="presentation" /></g></g><g data-mml-node="mo" data-semantic-type="operator" data-semantic-role="overaccent" data-semantic-annotation="accent:unknown" data-semantic-id="8" data-semantic-parent="9" aria-level="3" aria-posinset="2" aria-setsize="2" role="treeitem" data-semantic-speech="caret" data-semantic-prefix="Overscript" transform="translate(531,-24) translate(-550 0)" data-semantic-braille="â ¸â £" data-owns-id="8" aria-label="Overscript caret" aria-braillelabel="â ¸â £" aria-hidden="true"><use data-c="302" xlink:href="#MJX-1185-MM-S4-302" role="presentation" /></g></g></g><g data-mml-node="mo" data-semantic-type="operator" data-semantic-role="addition" data-semantic-id="10" data-semantic-parent="19" data-semantic-operator="infixop,+" aria-level="2" aria-posinset="4" aria-setsize="5" role="treeitem" data-semantic-speech="plus" transform="translate(3099.7,0)" data-semantic-braille="â ¬" data-owns-id="10" aria-label="plus" aria-braillelabel="â ¬" aria-hidden="true"><use data-c="2B" xlink:href="#MJX-1185-MM-N-2B" role="presentation" /></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(4099.9,0)" role="presentation"><g data-mml-node="mover" data-semantic-type="overscore" data-semantic-role="implicit" data-semantic-id="18" data-semantic-children="16,17" data-semantic-parent="19" data-semantic-attributes="texclass:ORD" aria-level="2" aria-posinset="5" aria-setsize="5" role="treeitem" data-semantic-owns="16 17" data-semantic-speech="ModifyingAbove x y z With caret" data-semantic-braille="â â ­â ½â µâ £â ¸â £â »" data-owns-id="18" aria-label="ModifyingAbove x y z With caret" aria-braillelabel="â â ­â ½â µâ £â ¸â £â »" aria-hidden="true" data-owns="16 17"><g data-mml-node="mrow" data-semantic-type="infixop" data-semantic-role="implicit" data-semantic-annotation="clearspeak:unit" data-semantic-id="16" data-semantic-children="11,12,13" data-semantic-content="14,15" data-semantic-parent="18" aria-level="3" aria-posinset="1" aria-setsize="2" role="treeitem" data-semantic-owns="11 14 12 15 13" data-semantic-speech="x y z" data-semantic-prefix="Base" data-semantic-braille="â ­â ½â µ" data-owns-id="16" aria-label="Base x y z" aria-braillelabel="â ­â ½â µ" aria-hidden="true" data-owns="11 14 12 15 13"><g data-mml-node="mi" data-semantic-type="identifier" data-semantic-role="latinletter" data-semantic-font="italic" data-semantic-annotation="clearspeak:simple" data-semantic-id="11" data-semantic-parent="16" aria-level="4" aria-posinset="1" aria-setsize="5" role="treeitem" data-semantic-speech="x" data-semantic-braille="â ­" data-owns-id="11" aria-label="x" aria-braillelabel="â ­" aria-hidden="true"><use data-c="1D465" xlink:href="#MJX-1185-MM-I-1D465" role="presentation" /></g><g data-mml-node="mo" data-semantic-type="operator" data-semantic-role="multiplication" data-semantic-id="14" data-semantic-parent="16" data-semantic-added="true" data-semantic-operator="infixop,â¢" aria-level="4" aria-posinset="2" aria-setsize="5" role="treeitem" data-semantic-speech="times" transform="translate(572,0)" data-semantic-braille="â â ¡" data-owns-id="14" aria-label="times" aria-braillelabel="â â ¡" aria-hidden="true"><use data-c="2062" xlink:href="#MJX-1185-MM-N-2062" role="presentation" /></g><g data-mml-node="mi" data-semantic-type="identifier" data-semantic-role="latinletter" data-semantic-font="italic" data-semantic-annotation="clearspeak:simple" data-semantic-id="12" data-semantic-parent="16" aria-level="4" aria-posinset="3" aria-setsize="5" role="treeitem" data-semantic-speech="y" transform="translate(572,0)" data-semantic-braille="â ½" data-owns-id="12" aria-label="y" aria-braillelabel="â ½" aria-hidden="true"><use data-c="1D466" xlink:href="#MJX-1185-MM-I-1D466" role="presentation" /></g><g data-mml-node="mo" data-semantic-type="operator" data-semantic-role="multiplication" data-semantic-id="15" data-semantic-parent="16" data-semantic-added="true" data-semantic-operator="infixop,â¢" aria-level="4" aria-posinset="4" aria-setsize="5" role="treeitem" data-semantic-speech="times" transform="translate(1062,0)" data-semantic-braille="â â ¡" data-owns-id="15" aria-label="times" aria-braillelabel="â â ¡" aria-hidden="true"><use data-c="2062" xlink:href="#MJX-1185-MM-N-2062" role="presentation" /></g><g data-mml-node="mi" data-semantic-type="identifier" data-semantic-role="latinletter" data-semantic-font="italic" data-semantic-annotation="clearspeak:simple" data-semantic-id="13" data-semantic-parent="16" aria-level="4" aria-posinset="5" aria-setsize="5" role="treeitem" data-semantic-speech="z" transform="translate(1062,0)" data-semantic-braille="â µ" data-owns-id="13" aria-label="z" aria-braillelabel="â µ" aria-hidden="true"><use data-c="1D467" xlink:href="#MJX-1185-MM-I-1D467" role="presentation" /></g></g><g data-mml-node="mo" data-semantic-type="operator" data-semantic-role="overaccent" data-semantic-annotation="accent:unknown" data-semantic-id="17" data-semantic-parent="18" aria-level="3" aria-posinset="2" aria-setsize="2" role="treeitem" data-semantic-speech="caret" data-semantic-prefix="Overscript" transform="translate(764.5,-23) translate(-790.5 0)" data-semantic-braille="â ¸â £" data-owns-id="17" aria-label="Overscript caret" aria-braillelabel="â ¸â £" aria-hidden="true"><use data-c="302" xlink:href="#MJX-1185-MM-S6-302" role="presentation" /></g></g></g></g></g></svg><span aria-hidden="true" class="visually-hidden">\widehat{x}+\widehat{xy} + \widehat{xyz}</span></mjx-container></li>
</ul>
<hr>
<p>This text is <a href="/assets/2013/How%20to%20include%20MathJax%20in%20an%20epub3%20file%20to%20work%20with%20iBooks%20%28and%20possibly%20others%29.epub">available as an epub3 file</a> which includes MathJax and should run on iOS devices.</p>
<hr>
<p><em>Comments</em></p>
<ul>
<li><strong>Lila Roberts</strong>, 2013/01/15<br>
Iâd like to try to create an epub fileâI must admit the opf file is quite intimidating. pandoc looks nice; but I do have inDesign and BlueGriffon. Iâll keep you posted. Thanks, Peter!
<ul>
<li><strong>Peter</strong>, 2013/01/15<br>
yes, creating opf files is a pain. For experiments, you can just hack the sample file from the post. iBooks doesnât complain if the opf is incomplete, so you can just add jsxgraph etc to the file, too.</li>
</ul>
</li>
<li><strong>AndrewMcDermott</strong>, 2013/01/25<br>
Hi Peter<br>
Great post, Iâll give this a go in the next week or so hopefully, if things calm down a little on our project. Will let you know how I get on!
<ul>
<li><strong>Peter</strong>, 2013/01/25<br>
great! let me know how it goes.</li>
</ul>
</li>
<li><strong>Peter</strong>, 2013/02/14<br>
Hi Andrew. I think this was caught in moderation â sorry. Great to hear it works for you. I hope we can get HTML output running again since that behaves better wrt to CSS.<br>
You can of course include both images and MathML and have MathJax replace the images with its rendering. That way you can support all systems using the same file.</li>
<li><strong>Johannes Wilm</strong>, 2013/05/04<br>
nice one! We have included this in our javascript based epub generator at <a href="http://www.fiduswriter.com">http://www.fiduswriter.com</a>. I must admit though that I haven't found any ereaders that can make use of this. Is there a list somewhere of what readers support javascript? I noticed thatyou guys are really against prerendering things, but I wonder if maybe thatis needed anyway. So at first I tried looking at the style declarations that are being included in the -section by mathjax. The most important thing missing there seems to be the font-face declarations. I haven'tlooked too much into whether they can be recreated some way.<br>
The other way one could go would be to try to convert the rendered SVG to a canvas element and from there to an img, which could be saved within the epub. I haven't tried it, but was thinking of something like <a href="https://github.com/gabelerner/canvg">https://code.google.com/p/canvg/</a>.<br>
Are there any other recommentations you have?
<ul>
<li><strong>Peter</strong>, 2013/05/05<br>
Hi Johannes, sorry that this was stuck in the moderation queue. Somehow I didnât get the notificationâ¦ This warrants a longer reply, as your comment is hitting on many problems and misconceptions at once ð (not you personal, just the way the comment can be misunderstood).</li>
<li><strong>Peter</strong>, 2013/05/05<br>
Ok, hereâs a longer attempt.<br>
The solution was only tested on iBooks. There are hardly any other javascript-enabled readers out there since epub3 does not require javascript support (although it at least premits it as opposed to epub2). I try to keep <a href="http://docs.mathjax.org/en/latest/misc/epub.html">docs.mathjax.org/en/latest/misc/epub.html</a> up to date but I know a number of Android apps are missing (one of which actually supports javscript).<br>
Why MathJax people often appear to be âagainstâ pre-rendering is simple: thatâs what MathJax set out to eliminate! Especially in professional publishing thereâs a long history of rendering MathML as images (for over a decade now). We need to get beyond that. Another reason is that the MathJax team tries to get another point across: thereâs no need anymore! Every epub3 reader out there uses a modern browser engine underneath that MathJax supports. So they can all integrate MathJax internally to get MathML support. Also, by now, thereâs a MathML capable epub3 reader for every platform. Of course thatâs not enough for professional publishing, but they are far too conservative anyway.<br>
Also, MathML is the only way to get accessible mathematics right now. Alt-text is simply wrong (except when itâs MathML I guess) â it is not adequate in todayâs a11y world where several groups need drastically different rendering, mixed modes and verbosity levels (blind, low vision, learning disabilities etc).<br>
Now image renderings (well, SVG anyway) would be ok if anybody supported epub3âs switch element â then at least, publishing could develop forward.<br>
Sp youâre right: if fiduswriter wants to do epub3 production that works everywhere today, then image renderings are the only stable choice â as much as it pains me to say. At the same time, make sure youâre not stuck at that (too many math solutions are). A generally bad but here fitting example is the proprietary horror that is the iBooks Author format. If you use TeX input in iBA2, then youâll end up with SVG and MathML in the file, likely so that Apple can switch to MathML once Safari supports MathML properly (which may never be the case since they have never paid anyone to actually develop itâ¦). For a wonderful example of inconsistency: iBA2 also accepts MathML input, which gets copied as is â so wonât display properly when the MathML is beyond Safariâs limited MathML supportâ¦ Way to push MathML, Appleâ¦<br>
Finally, MathJax output cannot be very well pre-rendered, even as SVG. The HTML-CSS output depends strongly on the viewport configuration at the time of rendering. Which means reflow (which is basically the point of ebooks) easily screws it up, especially when fancy new CSS tricks comes into play at that point. Even the SVG output cannot be pre-produced on the level of real MathJax rendering, linebreaking and other tricks break (besides it blows when it comes to simple things like night mode and more generally at accessibility).<br>
PS: a canvas output is in our backlog.</li>
</ul>
</li>
<li><strong>Johannes Wilm</strong>, 2013/05/05<br>
I see. The epub with mathjax in it worked fine in IBooks, while in Adobe Digital Editings (installed via Wine) and my Nook Glow Light, it just doesn't run the Javascript. It seems to crash the ebook reading app that comes with Calibre.<br>
Epubs themselves may have a limited lifespan, as ebook readers will get fullblown browsers with time, and once there is MathML support everywhere, we may just need a smaller script of some kind to translate Tex-based maths to MathML... The point is that the landscape is changing rapidly and that one needs to adjust one's solutions quite a lot over the next few years.<br>
So, I was thinking: To get smething that is working with today's devices, instead of this:<br>
<code>$X=Y^2$</code><br>
which is rendered fine on only some devices, have something like this:<br>
&nbsp;<br>
Then the ebook readers that cannot run jaascript will show the image and those that can (IBooks) can calculate the mathjax formula. Of course, mathjax has to be run manually with some javascript, as it cannot find the equation it should render as easily, but I'm sure this can be done.<br>
As for SVG vs. IMG -- I didn't look enough at the svg-canvas library, but assuming that it permits me to copy an already rendered SVG to a canvas, that should mean that I should be able to create a canvas which easily can be converted to an IMG and then saved inside the epub.<br>
But you would maybe argue that it is preferable to just include the SVG directly? For that I assume I would copy the SVG code from the DOM, copy the extra style information that has been added to the header, and find the fonts that have been added through some other trick (cannot find them in hte header) and add those to the mix as well. Right?</li>
<li><strong>Johannes Wilm</strong>, 2013/05/05<br>
Ah, this system ate most of my code examples. let me try again:<br>
So, I was thinking: To get something that is working with todayâs devices, instead of this:<br>
<code>&lt;span class="equation"&gt;&lt;MATH&gt;X=Y^2&lt;/MATH&gt;&lt;/span&gt;</code><br>
which is rendered fine on only some devices, have something like this:<br>
<code>&lt;span class="equation" data-equation="X=Y^2"&gt;&lt;IMG src="..." alt="an equation showing X=Y^2"/&gt;&lt;/span&gt;</code>
<ul>
<li><strong>Peter</strong>, 2013/05/05<br>
As I wrote, ideally, you would produce some kind of image fallback and use the epub-switch element. Unfortunately, very few epub3  reading systems support it. Even worse, they often react the wrong way to it: using MahtML instead of the image :(<br>
Unfortunately, your "once there's MathML support everywhere" makes me cry a little as I just replied to <a href="https://groups.google.com/forum/?fromgroups=#!topic/mozilla.dev.platform/96dZw1jXTvM">https://groups.google.com/forum/?fromgroups=#!topic/mozilla.dev.platform/96dZw1jXTvM</a>. There's currently zero development going into browsers. I hope we can change that, but this will be a while.<br>
Anyway, yes, MathJax can easily replace images by rendering embedded code. Case in point: bookmarklets for doing that on <a href="http://Wordpress.com">Wordpress.com</a> and Wikipedia <a href="https://gist.github.com/pkra">https://gist.github.com/pkra</a><br>
You can use SVG -- both canvas and SVG are part of epub3. Grabbing MathJax output is certainly possible, but with constraints. Making MathJax work also outside the DOM (with those constraints) is in our backlog, but has been for a while. You might find <a href="https://github.com/agrbin/svgtex">https://github.com/agrbin/svgtex</a> interesting.</li>
</ul>
</li>
</ul>

</article>

<aside class="related">
  <span> To leave a comment <a href="mailto:p.krautzberger@gmail.com?subject=Comment%20re%20How%20to%20include%20MathJax%20in%20an%20epub3%20file%20to%20work%20with%20iBooks%20(and%20possibly%20others)">write me an email</a>.
  </span>
  <span> You can also <a href="/contact/">contact me</a>.</span>
</aside>




		</main>

  <footer class="container related">
    Â© 2022 <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">cc-by</a> (unless noted otherwise).
    For more, subscribe to the <a href="/atom.xml">RSS/Atom feed</a>, visit the <a href="/archive/">archive</a> or the <a href="/about/">about</a> page.
  </footer>

		<!-- Current page: /0129/ -->
	</body>
</html>
